<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>任务详情 - 轻松工作</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        // 设置根字体大小，用于rem适配
        (function() {
            var resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize';
            function recalc() {
                var clientWidth = document.documentElement.clientWidth;
                if (!clientWidth) return;
                // 以375px设计稿为基准，设置1rem=18px
                document.documentElement.style.fontSize = 18 * (clientWidth / 375) + 'px';
            }
            if (!document.addEventListener) return;
            window.addEventListener(resizeEvt, recalc, false);
            document.addEventListener('DOMContentLoaded', recalc, false);
        })();
    </script>
    <style>
        :root {
            /* 颜色方案 */
            --primary-color: #ff7e00;
            --primary-dark: #ff5f00;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --error-color: #f44336;
            --text-primary: #333;
            --text-secondary: #666;
            --text-muted: #999;
            --light-bg: #f8f9fa;
            --border-color: #e0e0e0;
            
            /* 尺寸规范 */
            --base-font-size: 0.75rem;
            --card-radius: 0.6rem;
            --btn-radius: 0.6rem;
            --spacing: 0.8rem;
            --nav-height: 3.5rem;
            
            /* 组件规范 */
            --card-shadow: 0 0.1rem 0.4rem rgba(0, 0, 0, 0.04);
            --btn-shadow: 0 0.15rem 0.6rem rgba(255, 126, 0, 0.25);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            height: 100%;
            font-size: initial;
        }
        
        body {
            background-color: var(--light-bg);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            font-size: var(--base-font-size);
            line-height: 1.4;
            padding-bottom: var(--nav-height);
        }
        
        /* 顶部区域 */
        .header {
            padding: var(--spacing);
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            box-shadow: var(--btn-shadow);
            flex-shrink: 0;
            position: sticky;
            top: 0;
            z-index: 100;
            height: var(--nav-height);
        }
        
        .top-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 100%;
        }
        
        .back-button {
            width: 1.8rem;
            height: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 0.5rem;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            flex: 1;
            min-width: 0;
        }
        
        .logo {
            width: 2rem;
            height: 2rem;
            background-color: white;
            border-radius: var(--card-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 0.6rem;
            font-weight: bold;
            color: var(--primary-color);
            font-size: 0.85rem;
            box-shadow: 0 0.15rem 0.4rem rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
        }
        
        .slogan h1 {
            font-size: 0.8rem;
            margin-bottom: 0.15rem;
            font-weight: 600;
            text-shadow: 0 0.08rem 0.15rem rgba(0, 0, 0, 0.1);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .slogan p {
            font-size: 0.6rem;
            opacity: 0.95;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* 已领取印章 */
        .claimed-badge {
            position: fixed;
            top: var(--nav-height);
            right: -2.2rem;
            background: var(--primary-dark);
            color: white;
            font-size: 0.7rem;
            padding: 0.3rem 2.5rem;
            transform: rotate(45deg);
            z-index: 99;
            font-weight: bold;
            box-shadow: 0 0.15rem 0.6rem rgba(255, 111, 0, 0.4);
            display: none;
        }
        
        /* 内容区域 */
        .content {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing);
            -webkit-overflow-scrolling: touch;
        }
        
        /* 任务卡片 */
        .task-card {
            background: white;
            border-radius: var(--card-radius);
            padding: var(--spacing);
            margin-bottom: var(--spacing);
            box-shadow: var(--card-shadow);
        }
        
        .task-header {
            display: flex;
            align-items: center;
            margin-bottom: var(--spacing);
        }
        
        .task-icon {
            width: 2.5rem;
            height: 2.5rem;
            background: #fef2e7;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: var(--spacing);
            color: var(--primary-color);
            font-size: 1rem;
            flex-shrink: 0;
        }
        
        .task-title {
            flex: 1;
            min-width: 0;
        }
        
        .task-name {
            font-weight: 600;
            margin-bottom: 0.2rem;
            font-size: 0.85rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .task-reward {
            color: var(--primary-color);
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        /* 信息卡片 */
        .info-card {
            background: white;
            border-radius: var(--card-radius);
            padding: var(--spacing);
            margin-bottom: var(--spacing);
            box-shadow: var(--card-shadow);
        }
        
        .info-header {
            display: flex;
            align-items: center;
            margin-bottom: 0.6rem;
            padding-bottom: 0.4rem;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .info-header i {
            color: var(--primary-color);
            margin-right: 0.4rem;
            font-size: 0.8rem;
        }
        
        .info-header h2 {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .info-content {
            font-size: var(--base-font-size);
            color: var(--text-secondary);
            line-height: 1.5;
        }
        
        .info-list {
            list-style-type: none;
        }
        
        .info-list li {
            margin-bottom: 0.4rem;
            position: relative;
            padding-left: 1rem;
        }
        
        .info-list li:before {
            content: "•";
            color: var(--primary-color);
            position: absolute;
            left: 0;
        }
        
        /* 任务详情 */
        .task-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.6rem;
            margin-top: 0.6rem;
        }
        
        .detail-item {
            display: flex;
            flex-direction: column;
        }
        
        .detail-label {
            font-size: 0.6rem;
            color: var(--text-muted);
            margin-bottom: 0.2rem;
        }
        
        .detail-value {
            font-size: var(--base-font-size);
            color: var(--text-primary);
            font-weight: 500;
        }
        
        /* 重要要求突出显示 */
        .requirement-highlight {
            background-color: #fff9f2;
            border-left: 3px solid var(--primary-color);
            padding: 0.4rem 0.6rem;
            margin: 0.6rem 0;
            border-radius: 0 0.3rem 0.3rem 0;
        }
        
        /* 操作步骤区域 */
        .steps-info {
            background: #fff9f2;
            border: 1px dashed #ffd8b8;
            border-radius: 0.4rem;
            padding: var(--spacing);
            margin-top: var(--spacing);
            position: relative;
        }
        
        .steps-info.hidden {
            filter: blur(5px);
            user-select: none;
            pointer-events: none;
        }
        
        .steps-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.7);
            color: var(--primary-color);
            font-weight: 500;
            font-size: var(--base-font-size);
            border-radius: 0.4rem;
        }
        
        .steps-list {
            list-style-type: none;
            counter-reset: step-counter;
        }
        
        .steps-list li {
            margin-bottom: var(--spacing);
            position: relative;
            padding-left: 2rem;
        }
        
        .steps-list li:before {
            counter-increment: step-counter;
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            width: 1.5rem;
            height: 1.5rem;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        /* 敏感信息区域 */
        .sensitive-info {
            background: #fff9f2;
            border: 1px dashed #ffd8b8;
            border-radius: 0.4rem;
            padding: var(--spacing);
            margin-top: var(--spacing);
        }
        
        .qr-code {
            text-align: center;
            margin: var(--spacing) 0;
        }
        
        .qr-code img {
            width: 8rem;
            height: 8rem;
            border: 1px solid #f0f0f0;
            border-radius: 0.4rem;
        }
        
        .qr-code p {
            margin-top: 0.4rem;
            font-size: 0.7rem;
            color: var(--text-secondary);
        }
        
        .link-box {
            background: var(--light-bg);
            border-radius: 0.4rem;
            padding: 0.6rem;
            margin-top: 0.6rem;
            word-break: break-all;
            font-size: 0.7rem;
            color: var(--text-secondary);
        }
        
        .copy-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 0.3rem;
            padding: 0.3rem 0.6rem;
            font-size: 0.6rem;
            margin-top: 0.4rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .copy-btn:hover {
            background: var(--primary-dark);
        }
        
        /* 客服联系区域 */
        .support-section {
            margin-top: var(--spacing);
            padding-top: var(--spacing);
            border-top: 1px dashed #eee;
            text-align: center;
        }
        
        .support-btn {
            display: inline-flex;
            align-items: center;
            background: var(--light-bg);
            color: var(--primary-color);
            border: 1px solid #ffd8b8;
            border-radius: var(--btn-radius);
            padding: 0.4rem 0.8rem;
            font-size: 0.7rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .support-btn i {
            margin-right: 0.3rem;
        }
        
        .support-btn:hover {
            background: #fff2e6;
        }
        
        /* 按钮区域 */
        .button-container {
            position: fixed;
            bottom: var(--nav-height);
            left: 0;
            right: 0;
            padding: var(--spacing);
            background: var(--light-bg);
            z-index: 90;
            box-shadow: 0 -0.1rem 0.4rem rgba(0, 0, 0, 0.05);
            display: flex;
            gap: var(--spacing);
        }
        
        .primary-btn {
            display: block;
            flex: 1;
            padding: 0.8rem;
            border: none;
            border-radius: var(--btn-radius);
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            box-shadow: var(--btn-shadow);
            transition: var(--transition);
        }
        
        .primary-btn:active {
            transform: translateY(0.1rem);
            box-shadow: 0 0.1rem 0.3rem rgba(255, 126, 0, 0.3);
        }
        
        .primary-btn.claimed {
            background: #e0e0e0;
            color: var(--text-muted);
            box-shadow: 0 0.1rem 0.3rem rgba(0, 0, 0, 0.1);
            cursor: default;
        }
        
        .secondary-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 3rem;
            padding: 0.8rem;
            border: none;
            border-radius: var(--btn-radius);
            background: white;
            color: var(--primary-color);
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
        }
        
        /* 底部导航 */
        .bottom-nav {
            background: white;
            display: flex;
            justify-content: space-around;
            padding: 0.5rem 0;
            box-shadow: 0 -0.08rem 0.6rem rgba(0, 0, 0, 0.1);
            z-index: 1000;
            border-top-left-radius: 0.75rem;
            border-top-right-radius: 0.75rem;
            flex-shrink: 0;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            height: var(--nav-height);
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-muted);
            font-size: 0.55rem;
            transition: var(--transition);
            padding: 0.2rem 0.6rem;
            border-radius: 0.5rem;
            border: 0.08rem solid transparent;
            text-decoration: none;
        }
        
        .nav-item.active {
            color: var(--primary-color);
            border-color: #ffecd1;
            transform: translateY(-0.1rem);
            background-color: #fff9f2;
        }
        
        .nav-item i {
            font-size: 0.9rem;
            margin-bottom: 0.15rem;
        }
        
        /* 模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--card-radius);
            width: 80%;
            max-width: 20rem;
            padding: 1rem;
            box-shadow: 0 0.2rem 1rem rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 1rem;
        }
        
        .modal-header i {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .modal-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .modal-message {
            font-size: var(--base-font-size);
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.5;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: space-between;
            gap: 0.5rem;
        }
        
        .modal-btn {
            flex: 1;
            padding: 0.6rem;
            border: none;
            border-radius: 0.4rem;
            font-size: var(--base-font-size);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .modal-btn.cancel {
            background: #f0f0f0;
            color: var(--text-secondary);
        }
        
        .modal-btn.cancel:hover {
            background: #e0e0e0;
        }
        
        .modal-btn.confirm {
            background: var(--primary-color);
            color: white;
        }
        
        .modal-btn.confirm:hover {
            background: var(--primary-dark);
        }
        
        /* 倒计时样式 */
        .countdown {
            color: var(--primary-dark);
            font-weight: 600;
        }
        
        /* 媒体查询适配不同尺⼨设备 */
        @media (max-width: 320px) {
            .task-details {
                grid-template-columns: 1fr;
            }
            
            .button-container {
                flex-direction: column;
            }
        }
        
        @media (min-width: 500px) {
            .content {
                padding: 1rem;
            }
            
            .task-card, .info-card {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- 顶部区域 -->
    <div class="header">
        <div class="top-section">
            <div class="back-button" id="backButton">
                <i class="fas fa-arrow-left"></i>
            </div>
            <div class="logo-section">
                <div class="logo">易</div>
                <div class="slogan">
                    <h1>任务详情</h1>
                    <p>轻松工作，赚点外快</p>
                </div>
            </div>
            <div style="width: 1.8rem;"></div> <!-- 占位元素，用于平衡布局 -->
        </div>
    </div>
    
    <!-- 已领取印章 -->
    <div class="claimed-badge" id="claimedBadge">已领取</div>
    
    <!-- 内容区域 -->
    <div class="content">
        <!-- 任务概览卡片 -->
        <div class="task-card">
            <div class="task-header">
                <div class="task-icon">
                    <i class="fas fa-pencil-alt"></i>
                </div>
                <div class="task-title">
                    <div class="task-name">文案写作 - 产品介绍文章</div>
                    <div class="task-reward">赏金: ¥15/单</div>
                </div>
            </div>
        </div>
        
        <!-- 任务信息卡片 -->
        <div class="info-card">
            <div class="info-header">
                <i class="fas fa-info-circle"></i>
                <h2>任务信息</h2>
            </div>
            <div class="task-details">
                <div class="detail-item">
                    <span class="detail-label">任务ID</span>
                    <span class="detail-value">#T20231025001</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">截止时间</span>
                    <span class="detail-value">2023-11-05 23:59</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">剩余时间</span>
                    <span class="detail-value countdown">10天12小时30分</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">每人限领</span>
                    <span class="detail-value">1个</span>
                </div>
            </div>
        </div>
        
        <!-- 任务详情卡片 -->
        <div class="info-card">
            <div class="info-header">
                <i class="fas fa-tasks"></i>
                <h2>任务详情</h2>
            </div>
            <div class="info-content">
                <p>为我们新推出的智能手表撰写一篇800字左右的产品介绍文章，突出其健康监测、长续航和时尚外观等特点。文章需语言流畅，有吸引力，能够引起读者购买欲望。</p>
            </div>
        </div>
        
        <!-- 任务要求卡片 -->
        <div class="info-card">
            <div class="info-header">
                <i class="fas fa-clipboard-check"></i>
                <h2>任务要求</h2>
            </div>
            <div class="info-content">
                <div class="requirement-highlight">
                    <strong>重要要求：</strong>文章必须原创，抄袭率低于15%，否则将不予通过
                </div>
                <ul class="info-list">
                    <li>文章字数800-1000字，不得低于800字</li>
                    <li>需包含产品主要功能描述</li>
                    <li>需突出产品与竞品相比的优势</li>
                    <li>文章需原创，抄袭率低于15%</li>
                    <li>提交格式为Word文档(.doc或.docx)</li>
                    <li>需在截止日期前提交</li>
                </ul>
            </div>
        </div>
        
        <!-- 操作步骤卡片 - 初始隐藏，领取后显示 -->
        <div class="info-card">
            <div class="info-header">
                <i class="fas fa-list-ol"></i>
                <h2>操作步骤</h2>
            </div>
            <div class="info-content">
                <div class="steps-info hidden" id="stepsInfo">
                    <div class="steps-placeholder">领取任务后查看操作步骤</div>
                    
                    <ol class="steps-list">
                        <li>访问指定网站并注册账号</li>
                        <li>完成身份验证流程</li>
                        <li>按照要求撰写产品介绍文章</li>
                        <li>通过指定渠道提交您的作品</li>
                        <li>等待审核结果，通常需要1-3个工作日</li>
                    </ol>
                    
                    <div class="qr-code">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://example.com/registration/T20231025001" alt="注册二维码">
                        <p>扫码访问注册页面</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 审核标准卡片 -->
        <div class="info-card">
            <div class="info-header">
                <i class="fas fa-star"></i>
                <h2>审核标准</h2>
            </div>
            <div class="info-content">
                <ul class="info-list">
                    <li>内容符合要求，无偏离主题</li>
                    <li>语句通顺，无错别字和语法错误</li>
                    <li>文章结构清晰，逻辑连贯</li>
                    <li>原创度达到85%以上</li>
                    <li>按时提交任务成果</li>
                    <li>审核周期：提交后1-3个工作日内完成审核</li>
                </ul>
            </div>
        </div>
        
        <!-- 提交指南卡片 -->
        <div class="info-card">
            <div class="info-header">
                <i class="fas fa-paper-plane"></i>
                <h2>提交指南</h2>
            </div>
            <div class="info-content">
                <p>请通过以下方式提交您的作品：</p>
                
                <div class="sensitive-info">
                    <div class="qr-code">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://example.com/task-submit/T20231025001" alt="提交二维码">
                        <p>扫码提交任务成果</p>
                    </div>
                    
                    <p>或通过链接提交：</p>
                    <div class="link-box">
                        https://example.com/task-submit/T20231025001
                    </div>
                    <button class="copy-btn">复制链接</button>
                    
                    <p style="margin-top: 0.8rem; font-size: 0.7rem; color: #888;">
                        请注意：提交后请保留凭证，审核通过后赏金将在24小时内发放到您的账户。
                    </p>
                    
                    <div class="support-section">
                        <button class="support-btn" id="supportButton">
                            <i class="fas fa-headset"></i> 联系客服
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 按钮区域 -->
    <div class="button-container">
        <button class="primary-btn" id="claimButton">领取任务</button>
        <button class="secondary-btn" id="supportButtonBottom">
            <i class="fas fa-headset"></i>
        </button>
    </div>
    
    <!-- 底部导航 -->
      <div class="bottom-nav">
        <a href="index.html" class="nav-item">
            <i class="fas fa-home"></i>
            <span>首页</span>
        </a>
        <a href="doer-client-tasks-list.html" class="nav-item active">
            <i class="fas fa-th-large"></i>
            <span>任务</span>
        </a>
        <a href="doer-client-messages-list.html" class="nav-item">
            <i class="fas fa-comment-dots"></i>
            <span>消息</span>
        </a>
        <a href="doer-client-profile-index.html" class="nav-item">
            <i class="fas fa-user"></i>
            <span>我的</span>
        </a>
    </div>

    
    <!-- 确认领取模态框 -->
    <div class="modal" id="confirmationModal">
        <div class="modal-content">
            <div class="modal-header">
                <i class="fas fa-clipboard-check"></i>
                <div class="modal-title">确认领取任务</div>
            </div>
            <div class="modal-message">
                您确定要领取"文案写作 - 产品介绍文章"任务吗？<br>
                领取后需在<span class="countdown">10天12小时30分</span>内完成并提交。
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="cancelButton">取消</button>
                <button class="modal-btn confirm" id="confirmButton">确认领取</button>
            </div>
        </div>
    </div>
    
    <!-- 客服联系模态框 -->
    <div class="modal" id="supportModal">
        <div class="modal-content">
            <div class="modal-header">
                <i class="fas fa-headset"></i>
                <div class="modal-title">联系客服</div>
            </div>
            <div class="modal-message">
                <p>如果您在任务过程中遇到问题，可以通过以下方式联系客服：</p>
                <ul class="info-list" style="margin-top: 0.5rem;">
                    <li>客服QQ: 123456789</li>
                    <li>客服微信: easywork-support</li>
                    <li>工作时间: 工作日 9:00-18:00</li>
                </ul>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" id="closeSupportButton">关闭</button>
                <button class="modal-btn confirm" id="copyWechatButton">复制微信号</button>
            </div>
        </div>
    </div>

    <script>
        // 任务管理模块
        const TaskManager = {
            taskId: 'T20231025001',
            init() {
                this.bindEvents();
                this.loadTaskStatus();
                this.startCountdown();
            },
            
            bindEvents() {
                const claimButton = document.getElementById('claimButton');
                const confirmationModal = document.getElementById('confirmationModal');
                const cancelButton = document.getElementById('cancelButton');
                const confirmButton = document.getElementById('confirmButton');
                const stepsInfo = document.getElementById('stepsInfo');
                const claimedBadge = document.getElementById('claimedBadge');
                const supportButtons = document.querySelectorAll('#supportButton, #supportButtonBottom');
                const supportModal = document.getElementById('supportModal');
                const closeSupportButton = document.getElementById('closeSupportButton');
                const copyWechatButton = document.getElementById('copyWechatButton');
                const backButton = document.getElementById('backButton');
                
                // 返回按钮事件
                backButton.addEventListener('click', () => {
                    // 尝试返回上一页，如果没有历史记录则跳转到主页
                    if (window.history.length > 1) {
                        window.history.back();
                    } else {
                        window.location.href = 'index.html'; // 默认主页
                    }
                });
                
                // 初始化任务状态
                this.updateTaskStatus();
                
                // 点击领取按钮
                claimButton.addEventListener('click', () => {
                    if (!this.isTaskClaimed()) {
                        confirmationModal.style.display = 'flex';
                    } else {
                        window.location.href = 'task-submission.html?taskId=' + this.taskId;
                    }
                });
                
                // 点击取消按钮
                cancelButton.addEventListener('click', () => {
                    confirmationModal.style.display = 'none';
                });
                
                // 点击确认领取按钮
                confirmButton.addEventListener('click', () => {
                    this.claimTask();
                    confirmationModal.style.display = 'none';
                    
                    // 模拟API请求
                    setTimeout(() => {
                        alert('任务领取成功！请在规定时间内完成并提交。');
                    }, 300);
                });
                
                // 联系客服按钮
                supportButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        supportModal.style.display = 'flex';
                    });
                });
                
                // 关闭客服模态框
                closeSupportButton.addEventListener('click', () => {
                    supportModal.style.display = 'none';
                });
                
                // 复制微信号
                copyWechatButton.addEventListener('click', () => {
                    navigator.clipboard.writeText('easywork-support').then(() => {
                        copyWechatButton.textContent = '已复制';
                        setTimeout(() => {
                            copyWechatButton.textContent = '复制微信号';
                            supportModal.style.display = 'none';
                        }, 1500);
                    });
                });
                
                // 点击模态框外部关闭
                [confirmationModal, supportModal].forEach(modal => {
                    modal.addEventListener('click', (event) => {
                        if (event.target === modal) {
                            modal.style.display = 'none';
                        }
                    });
                });
                
                // 复制链接功能
                const copyButton = document.querySelector('.copy-btn');
                if (copyButton) {
                    copyButton.addEventListener('click', () => {
                        const link = document.querySelector('.link-box').textContent;
                        navigator.clipboard.writeText(link).then(() => {
                            const originalText = copyButton.textContent;
                            copyButton.textContent = '已复制';
                            setTimeout(() => {
                                copyButton.textContent = originalText;
                            }, 2000);
                        });
                    });
                }
            },
            
            // 检查任务是否已领取
            isTaskClaimed() {
                return localStorage.getItem(`task_${this.taskId}_claimed`) === 'true';
            },
            
            // 加载任务状态
            loadTaskStatus() {
                // 从localStorage加载任务状态
                // 实际应用中应该从服务器获取
                if (!localStorage.getItem(`task_${this.taskId}_claimed`)) {
                    localStorage.setItem(`task_${this.taskId}_claimed`, 'false');
                }
            },
            
            // 领取任务
            claimTask() {
                localStorage.setItem(`task_${this.taskId}_claimed`, 'true');
                this.updateTaskStatus();
            },
            
            // 更新任务状态UI
            updateTaskStatus() {
                const claimButton = document.getElementById('claimButton');
                const stepsInfo = document.getElementById('stepsInfo');
                const claimedBadge = document.getElementById('claimedBadge');
                
                if (this.isTaskClaimed()) {
                    claimButton.textContent = '去提交';
                    claimButton.classList.add('claimed');
                    stepsInfo.classList.remove('hidden');
                    claimedBadge.style.display = 'block';
                } else {
                    claimButton.textContent = '领取任务';
                    claimButton.classList.remove('claimed');
                    stepsInfo.classList.add('hidden');
                    claimedBadge.style.display = 'none';
                }
            },
            
            // 倒计时功能
            startCountdown() {
                // 设置截止时间：2023-11-05 23:59
                const deadline = new Date('2023-11-05T23:59:59');
                
                const updateCountdown = () => {
                    const now = new Date();
                    const diff = deadline - now;
                    
                    if (diff <= 0) {
                        // 倒计时结束
                        const countdownElements = document.querySelectorAll('.countdown');
                        countdownElements.forEach(el => {
                            el.textContent = '已过期';
                            el.style.color = '#f44336';
                        });
                        
                        // 禁用领取按钮
                        const claimButton = document.getElementById('claimButton');
                        if (claimButton && !this.isTaskClaimed()) {
                            claimButton.disabled = true;
                            claimButton.textContent = '已过期';
                            claimButton.style.background = '#e0e0e0';
                            claimButton.style.color = '#999';
                        }
                        
                        return;
                    }
                    
                    // 计算剩余时间
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    
                    // 更新倒计时显示
                    const countdownText = `${days}天${hours}小时${minutes}分`;
                    const countdownElements = document.querySelectorAll('.countdown');
                    countdownElements.forEach(el => {
                        el.textContent = countdownText;
                    });
                };
                
                // 初始更新一次
                updateCountdown();
                
                // 每分钟更新一次
                setInterval(updateCountdown, 60000);
            }
        };
        
        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            TaskManager.init();
        });
    </script>
</body>
</html>